# 善问-原理

当对未知问题寻求解决方案时，通过提问，理清：

- 解决方案所要达成的目标
- 每个分步骤（细节）的本质问题
- 如何解决这些分步骤
- 整体解决流程

当有其他聪明的解决方案时（tricks），要学会使用成熟方案。

- 做事，不仅只有一种方法。
- 每个人对同一种问题，有不同的看法。故而定义的目标是不同的，目标的达成，也是会有偏差。
- 集思广益，兼听则明。

## 善问

**热更新**

游戏保持最小核心（可称为更新器），热更新主要方式为清单文件比对。

1. 先拉取远端版本信息，获取到远端资源 url。
2. 从远端资源 url 下载清单文件，与本地清单进行比对，滤出需要更新的文件。
3. 依据过滤清单，从远端下载文件，以及每个文件的 checksum。
4. 文件下载到本地的临时目录后，进行校验，判断是否下载的正确资源。
5. 校验通过，进行资源解压，将资源放到游戏资源目录，删除临时目录。
6. 再回到第 1 步，直到更新到最新版。

问：

- 如何删除旧资源，以防止游戏包体越来越大？
- 如何确保资源链接是具权限访问，而非人人皆可访问？
- 如何确保存放在临时目录的文件不能轻易破解？
- 如何确保在更新时缩短玩家等待时间，以防无聊？
- 如何确保任意方式（断网）中断更新后，防止包体破碎而无法进入游戏？
- 如何确保中断更新后，仍能以旧版资源进入游戏？

清单文件加密方式：

- 清单文件每行都是密链，根据算法

## Tricks
所谓Tricks实际上都是指优化手段。即：如何在玩家不察觉的情况下，在有限的电脑空间（内存、磁盘速度、网速等），最大化视觉表现效果。

减面是常见做法，即当视角设定时，背向玩家的物体的面完全可被丢弃。从模型制作时即丢弃，比在场景图中丢弃更快。

- 可通过生命值掉的飞快，营造剑拔弩张、惊心动魄的感觉。
- 可通过步行（欣赏风景）、事件等过场动画来实现场景加载（过渡）
- 元素可复用，通过变色、形变、改布局等达到不同效果。
- [火车关卡](https://www.yystv.cn/p/3008)，可通过大型环形轨道，在切换场景时使用巧妙的视觉交互，完成火车的非线性轨迹和多场景关卡
- 碎尸（绝杀）可在武器触碰模型之前、替换通用散碎形体模型，达到破碎效果。
- 巧妙通过视角设定，可简化整体游戏场景复杂度。即，场景容量总是有限的，通过视角设定，营造庞大、无限的感觉。（例如，远景可使用Quad图；可视路径外的场景空无一物；添加厚重迷雾，减少远景渲染开销等）
- 颤屏（相机抖动）可营造动作一气呵成的打击效果。
- 粒子效果通常消耗较大，可采用布告板、序列帧动画等完成同样效果。
- 第一人称游戏中，主角模型通常只有两只手臂（没有头、躯干等）
- 圆锥可通过：圆心向一个方向移动，逐渐缩小其半径达到。
- 法线贴图，可将平整的模型上，附加上凹凸效果（通过计算反光量和反光角度）
- 抗锯齿本身时消耗性能的（通过多重采样），可通过虚化、模糊达到抗锯齿效果。
- 怎样在fps里把敌人的命中率严格控制在80%？
    答:100%击中，80%有效。
- 怎样做出逼真的倒地动作？
    答:动作做到要倒下时为止，剩下的用ragdoll。
- 如何让一张2D图片显示出3D效果？
    调整Z轴把它变成菱形即可。玩家会自动脑补成一张在3D空间里躺下的图片。
    
- 如何让武器后坐力更逼真
    枪口不要光上跳，先往上再往下，再往上…反复抖动几次，每次跳动幅度递减直到枪口趋向水平。这种射击动作很有弹性，能减少动作僵硬
    
- 对于漫画风游戏的动作，某些关键帧设计成拉伸和扭曲的模型，可以提高动作的“动感”。守望先锋是个经典案例。你不仔细逐帧检查是看不出问题的。

- 应该是所有厂商都用过的套路了
    复杂的远景可以用贴图代替，低性能平台的草地可以用交叉放置的贴图表现，一般情况玩家不会注意那么仔细。
    
- 高速移动的物体直接用位移代替物理运动最常见的应用是子弹，每帧都是瞬间移动到下一个位置，而不是用物理慢慢飞过去。远处也是瞬间消失。某些游戏甚至还有玩家背对时销毁某些物体的设定比如尸体转个身就不见了。

- 利用对象池，可重复减少内存消耗

- 利用径向模糊，可以模拟毛发效果

- 可用固定Quad贴图代替天空盒